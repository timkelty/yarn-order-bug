async function wait(x) {
    setTimeout(function () {
         async return x;
    }, 200);
}

function* sub() {
    yield 's';
//    await wait(10);
    yield 't';
    return 'fart'
}

async function* x() {
    log(yield 1);
    await wait(0);
    log(yield 2);
    log(yield* sub());
    log(yield 3);
    await wait(0);
    log(yield 4);
    return 'x';
}

//for await (a of x()) 
//log(a,JSON.stringify(a)); // await?

try {
    var j, i = x();
    while (j = await i.next(new Date().toISOString())) {
        log(j.value);
        if (j.done) 
            break;
    }
} catch (ex) {
    $error("while await", ex);
}
